[{"title":"Brute-Force-hard解题过程","url":"/2025/07/11/Brute-Force-hard/","content":"<h3 id=\"Brute-Force-hard解题过程\">Brute-Force-hard解题过程</h3>\n<p>源码中，使用了token，每次爆破需要带上token，burpsuit中带token爆破时，只能设置一个线程</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span>( <span class=\"keyword\">isset</span>( <span class=\"variable\">$_GET</span>[ <span class=\"string\">&#x27;Login&#x27;</span> ] ) ) &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// Check Anti-CSRF token  使用了token设置</span></span><br><span class=\"line\">\t<span class=\"title function_ invoke__\">checkToken</span>( <span class=\"variable\">$_REQUEST</span>[ <span class=\"string\">&#x27;user_token&#x27;</span> ], <span class=\"variable\">$_SESSION</span>[ <span class=\"string\">&#x27;session_token&#x27;</span> ], <span class=\"string\">&#x27;index.php&#x27;</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// Sanitise username input</span></span><br><span class=\"line\">\t<span class=\"variable\">$user</span> = <span class=\"variable\">$_GET</span>[ <span class=\"string\">&#x27;username&#x27;</span> ];</span><br><span class=\"line\">\t<span class=\"variable\">$user</span> = <span class=\"title function_ invoke__\">stripslashes</span>( <span class=\"variable\">$user</span> );</span><br><span class=\"line\">\t<span class=\"variable\">$user</span> = ((<span class=\"keyword\">isset</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">is_object</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>])) ? <span class=\"title function_ invoke__\">mysqli_real_escape_string</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>],  <span class=\"variable\">$user</span> ) : ((<span class=\"title function_ invoke__\">trigger_error</span>(<span class=\"string\">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class=\"string\">&quot;&quot;</span> : <span class=\"string\">&quot;&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// Sanitise password input</span></span><br><span class=\"line\">\t<span class=\"variable\">$pass</span> = <span class=\"variable\">$_GET</span>[ <span class=\"string\">&#x27;password&#x27;</span> ];</span><br><span class=\"line\">\t<span class=\"variable\">$pass</span> = <span class=\"title function_ invoke__\">stripslashes</span>( <span class=\"variable\">$pass</span> );</span><br><span class=\"line\">\t<span class=\"variable\">$pass</span> = ((<span class=\"keyword\">isset</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">is_object</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>])) ? <span class=\"title function_ invoke__\">mysqli_real_escape_string</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>],  <span class=\"variable\">$pass</span> ) : ((<span class=\"title function_ invoke__\">trigger_error</span>(<span class=\"string\">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class=\"string\">&quot;&quot;</span> : <span class=\"string\">&quot;&quot;</span>));</span><br><span class=\"line\">\t<span class=\"variable\">$pass</span> = <span class=\"title function_ invoke__\">md5</span>( <span class=\"variable\">$pass</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// Check database</span></span><br><span class=\"line\">\t<span class=\"variable\">$query</span>  = <span class=\"string\">&quot;SELECT * FROM `users` WHERE user = &#x27;<span class=\"subst\">$user</span>&#x27; AND password = &#x27;<span class=\"subst\">$pass</span>&#x27;;&quot;</span>;</span><br><span class=\"line\">\t<span class=\"variable\">$result</span> = <span class=\"title function_ invoke__\">mysqli_query</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>],  <span class=\"variable\">$query</span> ) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>( <span class=\"string\">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class=\"title function_ invoke__\">is_object</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>])) ? <span class=\"title function_ invoke__\">mysqli_error</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>]) : ((<span class=\"variable\">$___mysqli_res</span> = <span class=\"title function_ invoke__\">mysqli_connect_error</span>()) ? <span class=\"variable\">$___mysqli_res</span> : <span class=\"literal\">false</span>)) . <span class=\"string\">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>( <span class=\"variable\">$result</span> &amp;&amp; <span class=\"title function_ invoke__\">mysqli_num_rows</span>( <span class=\"variable\">$result</span> ) == <span class=\"number\">1</span> ) &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// Get users details</span></span><br><span class=\"line\">\t\t<span class=\"variable\">$row</span>    = <span class=\"title function_ invoke__\">mysqli_fetch_assoc</span>( <span class=\"variable\">$result</span> );</span><br><span class=\"line\">\t\t<span class=\"variable\">$avatar</span> = <span class=\"variable\">$row</span>[<span class=\"string\">&quot;avatar&quot;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// Login successful</span></span><br><span class=\"line\">\t\t<span class=\"variable\">$html</span> .= <span class=\"string\">&quot;&lt;p&gt;Welcome to the password protected area <span class=\"subst\">&#123;$user&#125;</span>&lt;/p&gt;&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"variable\">$html</span> .= <span class=\"string\">&quot;&lt;img src=\\&quot;<span class=\"subst\">&#123;$avatar&#125;</span>\\&quot; /&gt;&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// Login failed</span></span><br><span class=\"line\">\t\t<span class=\"title function_ invoke__\">sleep</span>( <span class=\"title function_ invoke__\">rand</span>( <span class=\"number\">0</span>, <span class=\"number\">3</span> ) );</span><br><span class=\"line\">\t\t<span class=\"variable\">$html</span> .= <span class=\"string\">&quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t((<span class=\"title function_ invoke__\">is_null</span>(<span class=\"variable\">$___mysqli_res</span> = <span class=\"title function_ invoke__\">mysqli_close</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>]))) ? <span class=\"literal\">false</span> : <span class=\"variable\">$___mysqli_res</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Generate Anti-CSRF token</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">generateSessionToken</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>抓包，将数据包发送到Intruder，设置爆破模式和爆破参数：</p>\n<table>\n<thead>\n<tr>\n<th>爆破模式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>sniper</td>\n<td>可以使用一组载荷和一到多个载荷位置。它会将每个载荷依次放入第一个位置，然后每个载荷放入第二个位置，依此类推。</td>\n</tr>\n<tr>\n<td>Battering ram</td>\n<td>此攻击使用一组载荷。它会遍历所有载荷，并将同一载荷同时放入所有已定义的位置中。</td>\n</tr>\n<tr>\n<td>Pitchfork</td>\n<td>此攻击使用多组载荷，每组载荷对应一个已定义的位置（最多20组）。即使用第一组中的第一个载荷、第二组中的第一个载荷，依此类推。</td>\n</tr>\n<tr>\n<td>Cluster bomb</td>\n<td>此攻击使用多组载荷，每组载荷对应一个已定义的位置（最多20组）。测试所有可能的载荷组合排列。</td>\n</tr>\n</tbody>\n</table>\n<p><img src=\"/2025/07/11/Brute-Force-hard/1.png\" alt></p>\n<p>加载password字典：</p>\n<p><img src=\"/2025/07/11/Brute-Force-hard/2.png\" alt></p>\n<p>设置每次请求替换token：</p>\n<p><img src=\"/2025/07/11/Brute-Force-hard/3.png\" alt></p>\n<p>设置线程：</p>\n<p><img src=\"/2025/07/11/Brute-Force-hard/4.png\" alt></p>\n<p>点击start attack开始爆破。</p>\n","categories":["DVWA"],"tags":["DVWA"]},{"title":"MyBlogTest","url":"/2025/05/28/MyBlogTest/","content":"<h3 id=\"Hello-World！！\">Hello World！！</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">from</span> requests.exceptions <span class=\"keyword\">import</span> ProxyError, SSLError, RequestException</span><br><span class=\"line\"></span><br><span class=\"line\">URL = <span class=\"string\">&#x27;https://111.202.105.3/uid-boot/sys/smsForRegister&#x27;</span></span><br><span class=\"line\">count = <span class=\"number\">0</span></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;User-Agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:136.0) Gecko/20100101 Firefox/136.0&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;Cookie&#x27;</span>: <span class=\"string\">&#x27;JSESSIONID=AB6ADE46BD9B4597E0A3E50C5BC887A1; Hm_lvt_d6d7e39f1262e06fcdb922da33dbcfa2=1744793725; Hm_lpvt_d6d7e39f1262e06fcdb922da33dbcfa2=1744853724; HMACCOUNT=75B4139BEE6C06CB&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json;charset=utf-8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;Content-Length&#x27;</span>: <span class=\"string\">&#x27;106&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">data = <span class=\"string\">&#x27;&#123;&quot;phone&quot;:&quot;90365e56442d0f4b71d2d3b33e44dee5&quot;,&quot;imgCaptcha&quot;:&quot;&quot;,&quot;imgCheckKey&quot;:&quot;1&quot;,&quot;secretPhone&quot;:&quot;147****8522&quot;&#125;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 禁用代理（关键修复）</span></span><br><span class=\"line\">session = requests.Session()</span><br><span class=\"line\">session.trust_env = <span class=\"literal\">False</span>  <span class=\"comment\"># 忽略系统代理配置</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        rsp = session.post(</span><br><span class=\"line\">            url=URL,</span><br><span class=\"line\">            data=data,</span><br><span class=\"line\">            headers=headers,</span><br><span class=\"line\">            verify=<span class=\"literal\">False</span>,  <span class=\"comment\"># 跳过SSL验证（仅测试时使用）</span></span><br><span class=\"line\">            timeout=<span class=\"number\">10</span>  <span class=\"comment\"># 设置超时避免卡死</span></span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> rsp.status_code == <span class=\"number\">200</span>:</span><br><span class=\"line\">            count += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;第 <span class=\"subst\">&#123;count&#125;</span> 次请求成功 | 响应: <span class=\"subst\">&#123;rsp.text&#125;</span>&quot;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;请求失败 | 状态码: <span class=\"subst\">&#123;rsp.status_code&#125;</span> | 响应: <span class=\"subst\">&#123;rsp.text&#125;</span>&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">except</span> ProxyError:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;错误: 代理连接失败，请检查代理设置或关闭代理&quot;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span> SSLError:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;错误: SSL证书验证失败，尝试使用 verify=False&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> RequestException <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;网络错误: <span class=\"subst\">&#123;e&#125;</span>&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> Exception <span class=\"keyword\">as</span> e:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;未知错误: <span class=\"subst\">&#123;e&#125;</span>&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    time.sleep(<span class=\"number\">63</span>)  <span class=\"comment\"># 保持间隔</span></span><br></pre></td></tr></table></figure>\n"},{"title":"Hello World","url":"/2025/07/11/hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\">Quick Start</h2>\n<h3 id=\"Create-a-new-post\">Create a new post</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\">Run server</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\">Generate static files</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\">Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"}]